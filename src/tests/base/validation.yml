mptcptrace:
  - test: "column_values" 
    validations:
      - name: "increasing_value"
        csv: "c2s_seq_1"
        column: 2
        desc: "dummy: check sequence numbers grow"
tcptrace:
  - test: "number_of_flows"
    validations:
      - name: "min_value"
        target: 2
        desc: "Open minimum 2 flows"
      - name: "max_value"
        target: 4
        desc: "Open maximum 4 flows"
      - name: "exact_value"
        target: 4
        desc: "Open exactly 4 flows"
  # This tests the flows opened by the connection. See class FlowsTest
  - test: "flows"
    validations:
      # validates time between first packets of the first stream and the stream for which the index is passed. 
      - name: "min_delay"
        index: 1
        target: 2
        desc: "Minimum 2 seconds delay between opening of first and second flow"
      # validates time between first packets of streams for which the index is passed. 
      # index is now a compound value, handled by the validate method of the class MinDelayBetweenValidation
      # first index value is the base flow we compare to
      # second index is the flow we want to validate
      - name: "min_delay_between"
        index:
          - 1
          - 2
        target: 1
        desc: "Minimum 1 second delay between opening of second and third flow"
      - name: "attribute_minimum_difference"
        attribute: "first_packet"
        # first index value is the base flow we compare to
        # second index is the flow we want to validate
        index:
          - 0
          - 1
        target: 2
        desc: "first packet delay 2nd flow"
      - name: "attribute_maximum_ratio"
        attribute: "total_packets_a2b"
        # first index value is the base flow we compare to
        # second index is the flow we want to validate
        index:
          - 0
          - 1
        # flows[1].packets_a2b/flows[2].packets_a2b < 5%
        target: 0.05
        desc: "a->b packet ration flow 2 compard to flow1"
